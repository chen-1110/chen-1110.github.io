---
layout: post
categories: 技术文章
author: chen
title: Docker速通笔记
---
## 一、docker的作用

快速开发应用

目前的理解，之前我们要开发一个应用，需要在服务器上安装nginx，mysql等各类应用，docker提供的第一个便利是，帮助我们一键安装各类依赖应用（但是似乎现在云服务器本身也很便利了，只要花钱。。。）

快速构建应用

把一套软件环境打成软件包（这块没看懂，后面再看）

快速分享应用

这个很明显，打包好的应用上传到docker应用市场，直接从应用市场拉去应用很方便



docker的架构

![image-20250320225254832](https://raw.githubusercontent.com/chen-1110/image/main/image-20250320225254832.png)

一图抵万言，主要围绕两个核心，container和image



docker容器是什么

![image-20250320225435095](https://raw.githubusercontent.com/chen-1110/image/main/image-20250320225435095.png)

多个容器，共享操作系统内核，但是拥有自己的文件系统，cpu，内存，磁盘空间，轻量级的vm



二、如何用docker打包分享一个应用

1.安装docker

2.下载nginx镜像

3.使用镜像运行容器

4.进入容器，修改nginx默认页

5.将修改好的容器打包成新的镜像

6.登录应用市场，上传镜像

7.其他主机通过应用市场下载镜像

```
# 移除旧版本docker
sudo yum remove docker \
                  docker-client \
                  docker-client-latest \
                  docker-common \
                  docker-latest \
                  docker-latest-logrotate \
                  docker-logrotate \
                  docker-engine

# 配置docker yum源。
sudo yum install -y yum-utils
sudo yum-config-manager \
--add-repo \
http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo


# 安装 最新 docker
sudo yum install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 启动& 开机启动docker； enable + start 二合一
systemctl enable docker --now

# 配置加速
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
    "registry-mirrors": [
        "https://mirror.ccs.tencentyun.com",
        "https://docker.m.daocloud.io"
    ]
}
EOF
sudo systemctl daemon-reload
sudo systemctl restart docker


#查看运行中的容器
docker ps
#查看所有容器
docker ps -a
#搜索镜像
docker search nginx
#下载镜像
docker pull nginx
#下载指定版本镜像
docker pull nginx:1.26.0
#查看所有镜像
docker images
#删除指定id的镜像
docker rmi e784f4560448


#运行一个新容器
docker run nginx
#停止容器
docker stop keen_blackwell
#启动容器
docker start 592
#重启容器
docker restart 592
#查看容器资源占用情况
docker stats 592
#查看容器日志
docker logs 592
#删除指定容器
docker rm 592
#强制删除指定容器
docker rm -f 592
# 后台启动容器
docker run -d --name mynginx nginx
# 后台启动并暴露端口
docker run -d --name mynginx -p 80:80 nginx
# 进入容器内部
docker exec -it mynginx /bin/bash

# 提交容器变化打成一个新的镜像
docker commit -m "update index.html" mynginx mynginx:v1.0
# 保存镜像为指定文件
docker save -o mynginx.tar mynginx:v1.0
# 删除多个镜像
docker rmi bde7d154a67f 94543a6c1aef e784f4560448
# 加载镜像
docker load -i mynginx.tar 


# 登录 docker hub
docker login
# 重新给镜像打标签
docker tag mynginx:v1.0 leifengyang/mynginx:v1.0
# 推送镜像
docker push leifengyang/mynginx:v1.0
```

