---
layout: post
categories: 整理记录
author: chen
title: ddd实战课学习记录
---


![img](https://raw.githubusercontent.com/chen-1110/image/main/8a859915250ffcab04675fb02fdf34f8.8a859915.jpg)

用户接口层：http/rpc/mtop接口

应用层：负责编排多个领域协同的业务逻辑

领域层：某个实体的业务逻辑（也有多实体但很少，就当没有，比如一个订阅协议子域，会有代扣实体和托管实体。。。）

基础层：很好理解，db，rpc。。。





![img](https://raw.githubusercontent.com/chen-1110/image/main/3bb8915fd6e880d64e9029a1f8677473.3bb8915f.jpg)

ddd： 战略设计 + 战术设计

战略设计：建立领域模型，确定限界上下文

战术设计：技术实现，聚合根，实体，值对象，代码实现

战略设计怎么做？ 事件风暴

1.梳理所有的用户操作，事件，外部依赖，根据这些信息划分出领域实体及对象

2.将领域内的实体进行多个聚合，每个聚合有聚合根，值对象和实体，这些聚合在同一个微服务运行，聚合之间的边界时第一层边界

3.确定限界上下文，将多个聚合放到一个限界上下文内，即划分为一个领域模型，限界上下文是微服务之间的物理边界



限界上下文，类似一个标题/类目，划分了一个范围，这个范围里共用一套业务通用名词，通用定义。比如说我们讲order这个实体，在订单域和售后域可能是不同的含义，订单域和售后域通过各自的限界上下文，对这两个不同含义相同名称的不同实体做隔离

实体，一类抽象业务单元，可能对应一张表，也可能对应多张表，实体采用充血模型，将数据和行为逻辑都放在实体类里。值对象，对应表中的某一json列，一些非重要无需检索的信息，如下图人员是实体，地址信息是值对象。

![](https://raw.githubusercontent.com/chen-1110/image/main/136512ac4c65b3f2ed4b2898b40965f6.136512ac.jpg)



聚合：一组实体的内聚，聚合有一个聚合根，它是实体，同时它引用了该聚合内其他实体，来协同提供服务，聚合在领域层，同一聚合当需要多个实体时通过领域服务来提供向上服务，多个聚合通过上层应用服务来提供服务





领域建模过程总结：

1.事件风暴，将需求转化为一批事件/指令操作

2.定实体，在1中的一批事件中找到有哪些实体

3.分子域，将2中相似实体划分子域

4.写代码，将子域和实体对应到具体的代码
